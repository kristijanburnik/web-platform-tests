{
  "/" : {
    "matches": {
      "specification": "non_empty_list"
    },
    "/specification": {
      "/*": {
        "matches": {
          "name": "non_empty_string",
          "description": "non_empty_string",
          "scenarios": "non_empty_list"
        },
        "/scenarios/*": {
          "matches": {
            "name": "non_empty_string",
            "delivery_method": "@delivery_method_schema",
            "keyword_source": "@keyword_source_schema",
            "resource_origin": "@resource_origin_schema",
            "expectation": "@expectation_schema"
          },
          "extensions": {
            "meta": ""
          },
          "action": "generate",
          "path": "script-src/%(delivery_method)s/%(resource_origin)s/%(keyword_source)s/%(name)s.html",
          "template": {
            "__main__": "generic/template/test.%(__mode__)s.html.template",
            "test_js": "generic/template/script-src.test.js.template",
            "generated_disclaimer": "generic/template/generated.disclaimer.template"
          },
          "when": [
            {
              "match_any": [["%(delivery_method)s", "meta-csp"]],
              "do":[{
                "action": "update_extensions",
                "extensions": {
                  "meta": "\n    <meta http-equiv=\"Content-Security-Policy\" content=\"script-src '%(keyword_source)s'\">"
                }
              }]
            },
            {
              "match_any": [["%(delivery_method)s", "http-csp"]],
              "do": [{
                "action": "generate",
                "path": "script-src/%(delivery_method)s/%(resource_origin)s/%(keyword_source)s/%(name)s.html.headers",
                "template": "Content-Security-Policy: script-src '%(keyword_source)s'"
              }]
            }
          ]
        }
      }
    }
  },
  "#delivery_method_schema": ["http-csp", "meta-csp"],
  "#keyword_source_schema": ["self", "unsafe-inline", "unsafe-eval"],
  "#resource_origin_schema": ["same-origin", "cross-origin"],
  "#expectation_schema": ["allowed", "blocked"]
}
